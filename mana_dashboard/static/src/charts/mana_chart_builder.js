/** @odoo-module alias=mana_dashboard.chart_builder default=false **/
const a0_0x1d1fab=a0_0x5f38;(function(_0x5a2d1f,_0x3ffc8c){const _0x321d54=a0_0x5f38,_0x14438c=_0x5a2d1f();while(!![]){try{const _0x11887e=-parseInt(_0x321d54(0x112))/0x1*(-parseInt(_0x321d54(0x13f))/0x2)+parseInt(_0x321d54(0xed))/0x3*(-parseInt(_0x321d54(0x118))/0x4)+-parseInt(_0x321d54(0x10b))/0x5*(-parseInt(_0x321d54(0x127))/0x6)+-parseInt(_0x321d54(0x12b))/0x7*(-parseInt(_0x321d54(0x136))/0x8)+parseInt(_0x321d54(0x125))/0x9+parseInt(_0x321d54(0x10e))/0xa*(-parseInt(_0x321d54(0x12e))/0xb)+-parseInt(_0x321d54(0x139))/0xc;if(_0x11887e===_0x3ffc8c)break;else _0x14438c['push'](_0x14438c['shift']());}catch(_0x11e0ab){_0x14438c['push'](_0x14438c['shift']());}}}(a0_0x5736,0x6319f));
 function a0_0x5736(){const _0x36cb31=['isComponent','width','removed','getTime','componentType','xAxis','contentRect','type','set','removeEventListener','chart_type','bind','length','1213955izEIxh','config_id','extend','5170ApnZzr','origin_value','call','_update_script','179WjkltW','prototype','hasOwnProperty','apply','trigger_up','model','4itbTjP','_clone','onSeriesClick','match','isArray','_onDashboardThemeChanged','replace','drill_down_config','label','resize','parse','_onResize','stringify','2499102yDVgzw','defaults','6BRaVhm','_onOptionChanged','listenTo','add','4865lzMtGr','merge','template_category','6413TueBxY','default_template','error','getExtraOption','render','disable','BaseView','on_option_trait_change','24giPqrH','linked_config_ids','get_data_source','1562664kBkaaB','bus','traits','dataIndex','value','enable_drill_down','7196xsHJmj','onDashboardThemeChanged','default_option','trigger','addResizeListener','old_width','get_dashboard','get','dispose','setOption','addType','save_custom_props','name','init','timestamp','987132xBmNhu','is_prevew_widget','initialize','content','search_sensitive','chart','data','form_trait_id','height','template_type','view','DomComponents','removeResizeListener','get_category_by_index','push','getOption','addEventListener'];a0_0x5736=function(){return _0x36cb31;};return a0_0x5736();}
 import {BlockBase}  from '@mana_dashboard_base/mana_block_base';const BaseModel=BlockBase['BaseModel'],BaseView=BlockBase[a0_0x1d1fab(0x134)];
 import {ResizeManager}  from '@mana_dashboard/resize_manager/resize_manager';const addResizeListener=ResizeManager[a0_0x1d1fab(0x143)],removeResizeListener=ResizeManager[a0_0x1d1fab(0xf9)];
 import {evaluateExpr}  from '@web/core/py_js/py';
 function a0_0x5f38(_0x53e093,_0x11e32c){const _0x573610=a0_0x5736();return a0_0x5f38=function(_0x5f3869,_0x153f67){_0x5f3869=_0x5f3869-0xe9;let _0x5442a3=_0x573610[_0x5f3869];return _0x5442a3;},a0_0x5f38(_0x53e093,_0x11e32c);}
 import {_t}  from '@web/core/l10n/translation';
export  const builder=function(_0x26c667){const _0x1c8d06=a0_0x1d1fab;let _0x9370a7=BaseModel['extend']({'defaults':{...BaseModel['prototype'][_0x1c8d06(0x126)],'classes':['mana_chart',_0x26c667[_0x1c8d06(0x108)]],'attributes':{'config_id':undefined,'chart_type':_0x26c667[_0x1c8d06(0x108)]},'droppable':![],'traits':_0x26c667[_0x1c8d06(0x13b)]||[],'resizable':{'tl':0x0,'tc':0x1,'tr':0x0,'cl':0x0,'cr':0x0,'bl':0x0,'bc':0x1,'br':0x0},'default_option':_0x26c667[_0x1c8d06(0x141)],'chart_type':_0x26c667[_0x1c8d06(0x108)],'default_template':_0x26c667[_0x1c8d06(0x12f)],'template_category':_0x26c667[_0x1c8d06(0x12d)],'template_type':_0x26c667[_0x1c8d06(0xf6)],'search_sensitive':_0x26c667[_0x1c8d06(0xf1)],'enable_drill_down':_0x26c667[_0x1c8d06(0x13e)]||![],'traits':[{'type':'option_trait','name':'option_trait','label':_t('Block Settings'),'model':'mana_dashboard.block_settings','form_view_ref':'mana_dashboard.block_settings_form','context':{},'changeProp':0x1}]},'get_default_props'(){return{'default_content':this['get']('block_settings')||'{}'};},'initialize'(){const _0x3c7249=_0x1c8d06;BaseModel['prototype'][_0x3c7249(0xef)][_0x3c7249(0x115)](this,arguments),this['on']('change_date_range',()=>{const _0x4098b3=_0x3c7249;this[_0x4098b3(0x142)]('change:chart_option');}),this[_0x3c7249(0x129)](this,'change:attributes:config_id',this['_onChangeConfigId']),this[_0x3c7249(0x129)](this,'change:option_trait',this[_0x3c7249(0x135)]),this['listenTo'](this,'change:block_settings',this['on_block_settings_change']);},'on_block_settings_change'(){const _0x4de3b6=_0x1c8d06;this['view']&&this[_0x4de3b6(0xf7)][_0x4de3b6(0x128)]();},'_onChangeConfigId'(){const _0x1202f1=_0x1c8d06;this[_0x1202f1(0x106)]('chart_option',this[_0x1202f1(0x146)]('default_option'));},'on_option_trait_change'(){const _0x3a0942=_0x1c8d06;let _0x418949=this[_0x3a0942(0x146)]('option_trait'),_0x43dd30=_0x418949[_0x3a0942(0x133)],_0x3ee537=_0x418949['content'];_0x43dd30&&(_0x3ee537='{}');_0x3ee537=_0x3ee537['replace'](/null/g,'false');let _0x3e7331=evaluateExpr(_0x3ee537||'{}');this[_0x3a0942(0x106)]('block_settings',_0x3e7331),this[_0x3a0942(0xe9)]();},'parse_custom_props'(_0x5180aa){const _0x5a1bc1=_0x1c8d06;_0x5180aa=_0x5180aa||{},_0x5180aa=_0x5180aa[_0x5a1bc1(0x11e)](/null/g,'false');let _0x5a6540=evaluateExpr(_0x5180aa||'{}');this['set']('block_settings',_0x5a6540,{'silent':!![]});},'merge'(){const _0x31e509=_0x1c8d06;let _0x2795e3={};const _0x4ba762=_0x3da5ee=>{const _0x1323b4=a0_0x5f38;for(let _0x279f60 in _0x3da5ee){if(_0x3da5ee[_0x1323b4(0x114)](_0x279f60)){if(typeof _0x3da5ee[_0x279f60]!=typeof _0x2795e3[_0x279f60])_0x2795e3[_0x279f60]=_0x3da5ee[_0x279f60];else{if(Array[_0x1323b4(0x11c)](_0x2795e3[_0x279f60])&&Array[_0x1323b4(0x11c)](_0x3da5ee[_0x279f60]))for(let _0xf32817=0x0;_0xf32817<_0x3da5ee[_0x279f60][_0x1323b4(0x10a)];_0xf32817++){_0xf32817>=_0x2795e3[_0x279f60][_0x1323b4(0x10a)]?_0x2795e3[_0x279f60]['push'](_0x3da5ee[_0x279f60][_0xf32817]):Object[_0x1323b4(0x113)]['toString'][_0x1323b4(0x110)](_0x3da5ee[_0x279f60][_0xf32817])==='[object Object]'?_0x2795e3[_0x279f60][_0xf32817]=this[_0x1323b4(0x12c)](_0x2795e3[_0x279f60][_0xf32817],_0x3da5ee[_0x279f60][_0xf32817]):_0x2795e3[_0x279f60][_0xf32817]=_0x3da5ee[_0x279f60][_0xf32817];}else Object[_0x1323b4(0x113)]['toString'][_0x1323b4(0x110)](_0x3da5ee[_0x279f60])==='[object Object]'?_0x2795e3[_0x279f60]=this[_0x1323b4(0x12c)](_0x2795e3[_0x279f60],_0x3da5ee[_0x279f60]):_0x2795e3[_0x279f60]=_0x3da5ee[_0x279f60];}}}};for(let _0x2aeecb=0x0;_0x2aeecb<arguments[_0x31e509(0x10a)];_0x2aeecb++){_0x4ba762(arguments[_0x2aeecb]);}return _0x2795e3;},'_clone'(_0x109f5e){const _0x2b901c=_0x1c8d06;if(Array[_0x2b901c(0x11c)](_0x109f5e)){let _0x243bbd=[];for(let _0x5344a5=0x0;_0x5344a5<_0x109f5e[_0x2b901c(0x10a)];_0x5344a5++){let _0x10dede=_0x109f5e[_0x5344a5];_0x243bbd[_0x2b901c(0xfb)](this['_clone'](_0x10dede));}return _0x243bbd;}else{if(typeof _0x109f5e==='object'){let _0x2ffe8a={};for(let _0x35a623 in _0x109f5e){let _0x51e13c=_0x109f5e[_0x35a623];if(typeof _0x51e13c=='object'||Array[_0x2b901c(0x11c)](_0x51e13c))_0x2ffe8a[_0x35a623]=this[_0x2b901c(0x119)](_0x51e13c);else typeof _0x51e13c=='function'?_0x2ffe8a[_0x35a623]='function(){}':_0x2ffe8a[_0x35a623]=_0x51e13c;}return _0x2ffe8a;}else return typeof _0x109f5e=='function'?'function(){}':_0x109f5e;}},'get_chart_option'(){const _0x28483d=_0x1c8d06;let _0x32ee43=[];if(this[_0x28483d(0xf7)]&&this['view'][_0x28483d(0xf2)]){let _0x3d0948=this['view'][_0x28483d(0xf2)][_0x28483d(0xfc)]();_0x3d0948&&(_0x32ee43=Object['keys'](_0x3d0948));}let _0x206301=null,_0x21f302=this['view']['getExtraOption'](),_0x3c7cf6=this['get']('chart_option');return _0x21f302&&_0x3c7cf6&&(_0x206301=this['merge'](this['_clone'](_0x3c7cf6),_0x21f302)),!_0x206301&&(_0x206301=_0x3c7cf6||_0x21f302),_0x206301['support_options']=_0x32ee43,_0x206301;},'get_custom_props'(){const _0x1c0c7f=_0x1c8d06;let _0x99a30e=this[_0x1c0c7f(0x146)]('block_settings')||{};return _0x99a30e;},'get_custom_config_infos'(){const _0x5cb31f=_0x1c8d06;return[{'name':'option_trait','key':'form_trait_id','res_model':'mana_dashboard.block_settings','res_id':this['get']('attributes')[_0x5cb31f(0xf4)]}];},'_update_script'(_0x43dbc7){const _0x496307=_0x1c8d06;let _0x2227b1=_0x43dbc7[_0x496307(0x11b)](/\s*var\s+option\s*=\s*/),_0xd37fe2=_0x43dbc7[_0x496307(0x11b)](/\s*let\s+option\s*=\s*/);!_0x2227b1&&!_0xd37fe2&&(_0x43dbc7='let option = {};\n'+_0x43dbc7);let _0x52c9e0=_0x43dbc7[_0x496307(0x11b)](/\s*this.set_option\s*\(/),_0x5220df=_0x43dbc7[_0x496307(0x11b)](/\s*this.setOption\s*\(/);!_0x52c9e0&&!_0x5220df&&(_0x43dbc7=_0x43dbc7+'\n this.set_option(option);'),BaseModel[_0x496307(0x113)][_0x496307(0x111)][_0x496307(0x115)](this,[_0x43dbc7]);}},{'isComponent':_0x26c667[_0x1c8d06(0xfe)]}),_0x225340=BaseView[_0x1c8d06(0x10d)]({'init'(){const _0x2dd91d=_0x1c8d06;BaseView['prototype']['init'][_0x2dd91d(0x115)](this,arguments),this['chart']=null,this[_0x2dd91d(0x123)]=this['onResize'][_0x2dd91d(0x109)](this),this['old_width']=0x0,this['old_height']=0x0,this[_0x2dd91d(0x129)](this[_0x2dd91d(0x117)],'change:chart_option',this[_0x2dd91d(0x128)]);let _0x1ff233=this['get_env']();this[_0x2dd91d(0x140)]=this[_0x2dd91d(0x11d)][_0x2dd91d(0x109)](this),_0x1ff233[_0x2dd91d(0x13a)][_0x2dd91d(0xfd)]('mana_dashboard.dashboard_theme_changed',this['onDashboardThemeChanged']);},'initResizeListener'(){const _0x3aa349=_0x1c8d06;let _0x2f8c86=this[_0x3aa349(0x117)]['get']('is_dragging');if(_0x2f8c86)return;let _0x4a3db2=this[_0x3aa349(0x117)]['get']('attributes')[_0x3aa349(0x10c)];if(!_0x4a3db2)return;removeResizeListener(this['el'],this['_onResize']),addResizeListener(this['el'],this[_0x3aa349(0x123)]);},'_onDashboardThemeChanged'(){const _0x1b357d=_0x1c8d06;this[_0x1b357d(0xf2)]&&(this['chart'][_0x1b357d(0x147)](),this[_0x1b357d(0xf2)]=null),setTimeout(()=>{this['render']();},0x0);},'_onchange_theme'(){const _0xc9bef7=_0x1c8d06;this[_0xc9bef7(0x11d)]();},'beforeScriptExecuted'(){const _0x21f1bd=_0x1c8d06;this[_0x21f1bd(0x117)][_0x21f1bd(0x106)]('chart_option',null,{'silent':!![]});},'afterScriptExecuted'(){const _0xea7ed5=_0x1c8d06;this[_0xea7ed5(0xf2)]&&this[_0xea7ed5(0xf2)][_0xea7ed5(0x121)]();let _0x39c6cb=this[_0xea7ed5(0x117)][_0xea7ed5(0x146)]('attributes')[_0xea7ed5(0x10c)];if(!_0x39c6cb)return;let _0x1cc929=this['model'][_0xea7ed5(0x146)]('editor_ready');if(!_0x1cc929)return;let _0x5f3935=this[_0xea7ed5(0x117)][_0xea7ed5(0x146)]('loading_config');if(_0x5f3935)return;if(this[_0xea7ed5(0x117)]['get']('has_script')&&this[_0xea7ed5(0x117)][_0xea7ed5(0x146)]('script')){let _0x4d7ce0=this[_0xea7ed5(0x117)][_0xea7ed5(0x146)]('chart_option');if(!_0x4d7ce0){let _0x16d7bf=this['model'][_0xea7ed5(0x146)]('default_scripts');!_0x16d7bf?this[_0xea7ed5(0x117)][_0xea7ed5(0x106)]('chart_option',this['model']['get']('default_option')):setTimeout(()=>{const _0x428636=_0xea7ed5;this[_0x428636(0x117)]['execute_default_script']();},0x0);}}},'_onOptionChanged'(){const _0x137672=_0x1c8d06;let _0x4aa358=this[_0x137672(0x117)]['get']('chart_option');this[_0x137672(0xf2)]&&_0x4aa358?this[_0x137672(0xf2)][_0x137672(0x148)](_0x4aa358,{'notMerge':!![]}):this['renderChart'](_0x4aa358);let _0x267ade=JSON[_0x137672(0x122)](JSON[_0x137672(0x124)](this[_0x137672(0x131)]()||{}));this[_0x137672(0xf2)][_0x137672(0x148)](_0x267ade,{'notMerge':![]});},'onResize'(_0x47dad7){const _0x2aae48=_0x1c8d06;if(!this['chart'])return;let _0x1d2038=this[_0x2aae48(0x117)][_0x2aae48(0x146)]('is_dragging');if(_0x1d2038)return;this['resizeChart'](_0x47dad7);},'resizeChart'(_0x2006b5){const _0x29d265=_0x1c8d06;if(this[_0x29d265(0xf2)]){let _0x928fba=_0x2006b5[_0x29d265(0x104)][_0x29d265(0xff)],_0xd240c6=_0x2006b5[_0x29d265(0x104)][_0x29d265(0xf5)];if(_0x928fba==this[_0x29d265(0x144)]&&_0xd240c6==this['old_height'])return;this['old_width']=_0x928fba,this['old_height']=_0xd240c6,this[_0x29d265(0xf2)][_0x29d265(0x121)]();}},'handleClick'(_0x29028c){_0x29028c['preventDefault']();},'renderChart'(_0x386acd){const _0x2ce20f=_0x1c8d06;if(!this[_0x2ce20f(0xf2)]){let _0x4670ba=this[_0x2ce20f(0x117)][_0x2ce20f(0x146)]('theme');if(_0x4670ba){let _0x362386=this[_0x2ce20f(0x117)][_0x2ce20f(0x146)]('theme_name');this[_0x2ce20f(0xf2)]=echarts['init'](this['el'],_0x362386);}else{let _0x4c4839=this[_0x2ce20f(0x145)]();if(_0x4c4839){let _0x51d932=_0x4c4839['get_theme_name']();_0x51d932&&(this[_0x2ce20f(0xf2)]=echarts[_0x2ce20f(0xeb)](this['el'],_0x51d932));}}!this['chart']&&(this[_0x2ce20f(0xf2)]=echarts[_0x2ce20f(0xeb)](this['el']));}_0x386acd&&this[_0x2ce20f(0xf2)][_0x2ce20f(0x148)](_0x386acd,{'notMerge':!![]}),requestAnimationFrame(()=>{this['initResizeListener']();}),this[_0x2ce20f(0xf2)]['on']('click',_0x169e88=>{const _0x77d53d=_0x2ce20f;let _0x240cd4=this[_0x77d53d(0x145)]();if(_0x240cd4[_0x77d53d(0xee)]())return;_0x169e88[_0x77d53d(0x102)]==='series'&&this[_0x77d53d(0x11a)](_0x169e88);});},'onSeriesClick'(_0xe3ca61){const _0x1564ee=_0x1c8d06;let _0x10dc0f=_0xe3ca61[_0x1564ee(0x13c)],_0x2b8547=_0xe3ca61[_0x1564ee(0xea)],_0x59ae28=_0xe3ca61[_0x1564ee(0x13d)],_0x3c9317=this['model'][_0x1564ee(0x146)]('chart_option'),_0x5263a6=_0xe3ca61[_0x1564ee(0xf3)];if(_0x5263a6&&typeof _0x5263a6==='object')_0x5263a6[_0x1564ee(0x10f)]&&(_0x2b8547=_0x5263a6[_0x1564ee(0x10f)]);else{if(_0x3c9317['get_category_by_index'])_0x2b8547=_0x3c9317[_0x1564ee(0xfa)](_0x10dc0f);else{let _0x5a7ed3=_0x3c9317[_0x1564ee(0x103)],_0x4548e4=_0x5a7ed3&&_0x5a7ed3[_0x1564ee(0xf3)]&&_0x5a7ed3['data'][_0x10dc0f];_0x4548e4&&(typeof _0x4548e4==='object'&&_0x4548e4[_0x1564ee(0x10f)]&&(_0x2b8547=_0x4548e4[_0x1564ee(0x10f)]));}}let _0x2b5ee8=this[_0x1564ee(0x117)][_0x1564ee(0x146)]('config'),_0x3a4a23=_0x2b5ee8[_0x1564ee(0x11f)];if(_0x3a4a23){let _0x326005=parseInt(_0x3a4a23[0x0]);this[_0x1564ee(0x116)]('mana_dashboard.drill_down',{'config_id':_0x326005,'category':_0x2b8547,'model':this[_0x1564ee(0x117)],'value':_0x59ae28});}else _0x2b5ee8[_0x1564ee(0x137)]&&_0x2b5ee8[_0x1564ee(0x137)][_0x1564ee(0x10a)]>0x0?this[_0x1564ee(0x116)]('mana_dashboard.linked_actions',{'linked_config_ids':_0x2b5ee8[_0x1564ee(0x137)],'category':_0x2b8547,'model':this[_0x1564ee(0x117)],'value':_0x59ae28}):this['trigger_up']('mana_dashboard.view_chart_data',{'category':_0x2b8547,'model':this['model'],'value':_0x59ae28,'params':_0xe3ca61});},'getExtraOption'(){const _0x2a4194=_0x1c8d06;let _0x3d7fef=this[_0x2a4194(0x117)][_0x2a4194(0x146)]('block_settings');return _0x3d7fef;},'setOption'(_0x37cf30){const _0x46962a=_0x1c8d06;_0x37cf30[_0x46962a(0xec)]=new Date()[_0x46962a(0x101)](),this[_0x46962a(0x117)][_0x46962a(0x106)]('chart_option',_0x37cf30);},'set_option'(_0x3db9bf){this['setOption'](_0x3db9bf);},'setChartOption'(_0x2d9cf9){const _0x295397=_0x1c8d06;this[_0x295397(0x148)](_0x2d9cf9);},'set_chart_option'(_0x304637){const _0x16d303=_0x1c8d06;this[_0x16d303(0x148)](_0x304637);},'getDataSource'(_0x4a1bf7=0x0){const _0x4b26c1=_0x1c8d06;return this[_0x4b26c1(0x138)](_0x4a1bf7);},'setChartOption'(_0x5abc5a){const _0x598f5c=_0x1c8d06;_0x5abc5a['timestamp']=new Date()['getTime'](),this[_0x598f5c(0x117)][_0x598f5c(0x106)]('chart_option',_0x5abc5a);},'removed'(){const _0x13cf81=_0x1c8d06;BaseView[_0x13cf81(0x113)][_0x13cf81(0x100)][_0x13cf81(0x115)](this,arguments);let _0xcb7f9c=this['get_env']();_0xcb7f9c[_0x13cf81(0x13a)][_0x13cf81(0x107)]('mana_dashboard.dashboard_theme_changed',this[_0x13cf81(0x140)]),removeResizeListener(this['el'],this[_0x13cf81(0x123)]),this[_0x13cf81(0xf2)]&&(this[_0x13cf81(0xf2)]['dispose'](),this[_0x13cf81(0xf2)]=null);},'render'(..._0x35ac32){const _0x16f4f6=_0x1c8d06;BaseView[_0x16f4f6(0x113)][_0x16f4f6(0x132)]['apply'](this,_0x35ac32);if(this[_0x16f4f6(0xf2)]){try{this['chart']['dispose']();}catch(_0x380497){console[_0x16f4f6(0x130)](_0x380497);}this[_0x16f4f6(0xf2)]=null;}let _0x5be1bf=this['model'][_0x16f4f6(0x146)]('editor_ready');if(!_0x5be1bf)return this;let _0x470875=null,_0x40c7e5=this[_0x16f4f6(0x117)][_0x16f4f6(0x146)]('config');if(_0x40c7e5&&!this['model']['get']('loading_config')){_0x470875=this[_0x16f4f6(0x117)][_0x16f4f6(0x146)]('chart_option');if(!_0x470875){let _0x57a527=this['model'][_0x16f4f6(0x146)]('default_scripts');!_0x57a527&&(_0x470875=this[_0x16f4f6(0x117)][_0x16f4f6(0x146)]('default_option'));}_0x470875&&this[_0x16f4f6(0x117)][_0x16f4f6(0x106)]('chart_option',_0x470875);}return this;}});return(_0x417c66,_0x55dcd1={})=>{const _0x27fe27=_0x1c8d06;let _0x3310dd=_0x417c66[_0x27fe27(0xf8)];_0x417c66['BlockManager'][_0x27fe27(0x12a)](_0x26c667[_0x27fe27(0x105)],{'label':_0x26c667[_0x27fe27(0x120)],'category':_t('Charts'),'select':!![],'render':_0x26c667[_0x27fe27(0x132)],'content':_0x26c667[_0x27fe27(0xf0)]}),_0x3310dd[_0x27fe27(0x149)](_0x26c667[_0x27fe27(0x108)],{'model':_0x9370a7,'view':_0x225340});};};